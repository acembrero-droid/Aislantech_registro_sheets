<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AISLANTECH - Acceso</title>
    <style>
        :root { --amarillo: #eebc06; --fondo: #f4f4f4; --blanco: #ffffff; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--fondo); display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .card { background: var(--blanco); padding: 40px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); width: 380px; box-sizing: border-box; }
        h1 { color: var(--amarillo); text-align: center; margin-bottom: 25px; }
        
        .tabs { display: flex; margin-bottom: 25px; border-bottom: 2px solid #eee; }
        .tab { flex: 1; padding: 12px; text-align: center; cursor: pointer; font-weight: bold; color: #aaa; }
        .tab.active { color: var(--amarillo); border-bottom: 2px solid var(--amarillo); }

        .input-group { position: relative; margin-bottom: 15px; }
        input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; outline: none; font-size: 15px; }
        
        /* Icono de Ver Contrase√±a */
        .toggle-pass { 
            position: absolute; right: 12px; top: 50%; transform: translateY(-50%); 
            cursor: pointer; color: #aaa; font-size: 14px; user-select: none;
        }

        button { width: 100%; padding: 14px; background: var(--amarillo); border: none; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        button:disabled { background: #ccc; }
        
        .req-box { margin: 10px 0; display: none; font-size: 12px; color: #999; }
        .valid { color: #28a745; font-weight: bold; }
        .links { text-align: center; margin-top: 20px; font-size: 13px; color: #666; }
        .link { cursor: pointer; display: block; margin-top: 10px; }
    </style>
</head>
<body>

<div class="card">
    <h1>AISLANTECH</h1>
    
    <div id="tabs-container" class="tabs">
        <div id="tab-login" class="tab active" onclick="setMode('login')">Entrar</div>
        <div id="tab-signup" class="tab" onclick="setMode('signup')">Registrarse</div>
    </div>

    <div id="form-content">
        <div id="group-user" class="input-group" style="display:none">
            <input type="text" id="username" placeholder="Nombre completo">
        </div>

        <div class="input-group">
            <input type="email" id="email" placeholder="Email corporativo">
        </div>

        <div id="group-pass" class="input-group">
            <input type="password" id="password" placeholder="Contrase√±a" oninput="validarPass()">
            <span class="toggle-pass" onclick="togglePassword('password')">üëÅÔ∏è</span>
        </div>
        
        <div id="req-box" class="req-box">
            <div id="r-len">‚óã 8+ caracteres</div>
            <div id="r-num">‚óã Un n√∫mero</div>
            <div id="r-cap">‚óã Una may√∫scula</div>
        </div>

        <button id="btn-submit" onclick="enviar()">Entrar</button>

        <div class="links">
            <span id="link-recover" class="link" onclick="setMode('recover')">¬øOlvidaste tu contrase√±a?</span>
            <span id="link-back" class="link" style="display:none" onclick="setMode('login')">Volver al inicio</span>
        </div>
    </div>
</div>

<script>
    const API_URL = "https://script.google.com/macros/s/AKfycbwOT8K89aveRsOaIo7NEcSxkP_xDYzEQpaEnf07Jih0BrO8_YA5D0jdy4lrtfKpgcSE/exec"; 
    let modo = 'login';

    function setMode(m) {
        modo = m;
        document.getElementById('tabs-container').style.display = m === 'recover' ? 'none' : 'flex';
        document.getElementById('tab-login').className = m === 'login' ? 'tab active' : 'tab';
        document.getElementById('tab-signup').className = m === 'signup' ? 'tab active' : 'tab';
        document.getElementById('group-user').style.display = m === 'signup' ? 'block' : 'none';
        document.getElementById('group-pass').style.display = m === 'recover' ? 'none' : 'block';
        document.getElementById('req-box').style.display = m === 'signup' ? 'block' : 'none';
        document.getElementById('btn-submit').innerText = m === 'login' ? 'Entrar' : (m === 'signup' ? 'Crear Cuenta' : 'Enviar Enlace');
        document.getElementById('link-recover').style.display = m === 'login' ? 'block' : 'none';
        document.getElementById('link-back').style.display = m === 'recover' ? 'block' : 'none';
    }

    function togglePassword(id) {
        const input = document.getElementById(id);
        input.type = input.type === 'password' ? 'text' : 'password';
    }

    function validarPass() {
        if (modo !== 'signup') { document.getElementById('btn-submit').disabled = false; return; }
        const p = document.getElementById('password').value;
        const c1 = p.length >= 8, c2 = /[0-9]/.test(p), c3 = /[A-Z]/.test(p);
        document.getElementById('r-len').className = c1 ? 'valid' : '';
        document.getElementById('r-num').className = c2 ? 'valid' : '';
        document.getElementById('r-cap').className = c3 ? 'valid' : '';
        document.getElementById('btn-submit').disabled = !(c1 && c2 && c3);
    }

    async function enviar() {
        const payload = {
            action: modo,
            email: document.getElementById('email').value,
            password: document.getElementById('password').value,
            username: document.getElementById('username').value || "Usuario"
        };

        // UI Feedback
        document.getElementById('btn-submit').innerText = "Procesando...";
        document.getElementById('btn-submit').disabled = true;

        await fetch(API_URL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(payload) });

        setTimeout(() => {
            if (modo === 'recover') alert("Enlace enviado si el correo existe.");
            else if (modo === 'signup') alert("Registro enviado. Revisa tu email.");
            else window.location.href = "dashboard.html?user=" + encodeURIComponent(payload.email);
            setMode('login');
        }, 1000);
    }
</script>
</body>
</html>
